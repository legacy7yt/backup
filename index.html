<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>عرض ملف Excel</title>
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>

<h2>رفع وعرض ملف Excel</h2>
<input type="file" id="upload" accept="DAILY REPORT.xlsx"/>
<br><br>
<table id="excelTable" class="display" style="width:100%"></table>

<script>
document.getElementById('upload').addEventListener('change', function(e){
    const file = e.target.files[0];
    const reader = new FileReader();
    reader.onload = function(e){
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, {type:'array'});
        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
        const jsonData = XLSX.utils.sheet_to_json(firstSheet, {header:1});

        // مسح الجدول القديم
        $('#excelTable').DataTable().clear().destroy();

        // إنشاء جدول HTML
        const table = document.getElementById('excelTable');
        table.innerHTML = '';
        jsonData.forEach((row,i)=>{
            const tr = document.createElement('tr');
            row.forEach(cell=>{
                const td = document.createElement(i===0?'th':'td');
                td.innerText = cell;
                tr.appendChild(td);
            });
            table.appendChild(tr);
        });

        // تفعيل DataTable على الجدول
        $('#excelTable').DataTable();
    };
    reader.readAsArrayBuffer(file);
});
</script>

</body>
</html>
